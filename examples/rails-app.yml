---
state:
  bucket: stackmate-e2e-tests
  lockTable: stackmate-terraform-state-lock

environments:
  production:
    rails-app:
      type: application
      preset: rails
      environment:
        REDIS_URL: redis://${redis-kv.host}:${redis-kv:port}/0
        DB_URL: mysql://${mysql-db.user}:${mysql-db.password}@${mysql-db.host}/${mysql-db.db}:${mysql-db.port}
        S3_BUCKET: s3://${storage.stackmate-rails-app-storage.name}

      # Optional configuration:
      #
      # This is the same as preset: rails
      # tasks:
      #   deployment:
      #     - rails bundle
      #     - rails assets:publish
      #     - rails db:migrate
      #
      # volumes:
      #   - /mnt/some-mount-path
      #   - /mnt/another-mount-path
      #
      # cpu: 1
      # memory: 2048
      # the links should be auto-generated from the environment associations
      # links:
      #   - mysql-db
      #   - redis-kv
      #
      # ports:
      #   - 80
      #   - 443
      #
      #
      # TODO:
      #  domain: app.stackmate.io # association with dns service
      #  https: true # association with ssl service
      #  cdn: true # association with cdn service
